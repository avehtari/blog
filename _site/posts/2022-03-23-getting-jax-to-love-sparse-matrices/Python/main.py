import numpy as np
from scipy import sparse


def _symbolic_factor_csc(A_indices, A_indptr):
    # Assumes A_indices and A_indptr index the lower triangle of $A$ ONLY.
    n = len(A_indptr) - 1
    L_sym = [np.array([], dtype=int) for j in range(n)]
    children = [np.array([], dtype=int) for j in range(n)]

    for j in range(n):
        L_sym[j] = A_indices[A_indptr[j]:A_indptr[j + 1]]
        for child in children[j]:
            tmp = L_sym[child][L_sym[child] > j]
            L_sym[j] = np.unique(np.append(L_sym[j], tmp))

        if len(L_sym[j]) > 1:
            p = L_sym[j][1]
            children[p] = np.append(children[p], j)

    L_indptr = np.zeros(n + 1, dtype=int)
    L_indptr[1:] = np.cumsum([len(x) for x in L_sym])
    L_indices = np.concatenate(L_sym)

    return L_indices, L_indptr


def _deep_copy_csc(A_indices, A_indptr, A_x, L_indices, L_indptr):
    n = len(A_indptr) - 1
    L_x = np.zeros(len(L_indices))

    for j in range(0, n):
        copy_idx = np.nonzero(np.in1d(L_indices[L_indptr[j]:L_indptr[j + 1]],
                                      A_indices[A_indptr[j]:A_indptr[j + 1]]))[0]
        L_x[L_indptr[j] + copy_idx] = A_x[A_indptr[j]:A_indptr[j + 1]].copy()
    return L_x


def _sparse_cholesky_csc_impl(L_indices, L_indptr, L_x):
    n = len(L_indptr) - 1
    descendant = [[] for j in range(0, n)]
    for j in range(0, n):
        tmp = L_x[L_indptr[j]:L_indptr[j + 1]]
        for bebe in descendant[j]:
            k = bebe[0]
            Ljk = L_x[bebe[1]]
            pad = np.nonzero(L_indices[L_indptr[k]:L_indptr[k + 1]] == L_indices[L_indptr[j]])[0][0]
            update_idx = np.nonzero(np.in1d(L_indices[L_indptr[j]:L_indptr[j + 1]],
                                            L_indices[(L_indptr[k] + pad):L_indptr[k + 1]]))[0]
            tmp[update_idx] = tmp[update_idx] - Ljk * L_x[(L_indptr[k] + pad):L_indptr[k + 1]]

        diag = np.sqrt(tmp[0])
        L_x[L_indptr[j]] = diag
        L_x[(L_indptr[j] + 1):L_indptr[j + 1]] = tmp[1:] / diag
        for idx in range(L_indptr[j] + 1, L_indptr[j + 1]):
            descendant[L_indices[idx]].append((j, idx))
    return L_x


def sparse_cholesky_csc(A_indices, A_indptr, A_x):
    L_indices, L_indptr = _symbolic_factor_csc(A_indices, A_indptr)
    L_x = _deep_copy_csc(A_indices, A_indptr, A_x, L_indices, L_indptr)
    L_x = _sparse_cholesky_csc_impl(L_indices, L_indptr, L_x)
    return L_indices, L_indptr, L_x


# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    A_indices = np.array(
        [0, 1, 67, 84, 2, 11, 24, 49, 52, 76, 78, 3, 4, 5, 24, 39, 41, 54, 55, 62, 67, 79, 85, 90, 5, 18, 24, 55, 85, 6,
         16, 27, 31, 45, 48, 83, 84, 85, 86, 7, 28, 38, 57, 92, 8, 17, 32, 93, 99, 9, 10, 30, 35, 55, 82, 86, 99, 11,
         12, 94, 12, 16, 71, 94, 13, 28, 46, 65, 14, 19, 20, 30, 54, 59, 77, 86, 15, 16, 45, 16, 19, 27, 36, 45, 48, 51,
         66, 74, 79, 83, 89, 17, 32, 79, 18, 19, 66, 74, 86, 20, 54, 66, 21, 47, 61, 84, 97, 22, 26, 54, 69, 94, 23, 85,
         24, 40, 41, 52, 55, 76, 78, 85, 25, 47, 62, 71, 26, 53, 54, 61, 69, 89, 94, 27, 48, 83, 86, 88, 98, 28, 44, 46,
         57, 68, 76, 90, 92, 93, 99, 29, 91, 30, 35, 44, 55, 59, 86, 99, 31, 43, 85, 32, 33, 34, 42, 58, 64, 87, 35, 55,
         86, 99, 36, 42, 50, 79, 89, 37, 38, 44, 50, 51, 54, 89, 95, 97, 39, 44, 49, 54, 55, 60, 63, 70, 75, 79, 81, 90,
         93, 40, 41, 48, 68, 81, 91, 42, 50, 73, 43, 44, 46, 51, 69, 75, 76, 93, 95, 45, 57, 70, 78, 86, 46, 58, 69, 81,
         47, 62, 97, 48, 68, 83, 49, 55, 70, 50, 73, 89, 97, 51, 95, 52, 62, 70, 76, 78, 53, 54, 69, 79, 90, 94, 55, 70,
         85, 86, 99, 56, 57, 86, 92, 58, 64, 81, 87, 59, 60, 80, 61, 64, 69, 84, 94, 62, 70, 63, 81, 64, 87, 65, 66, 74,
         67, 84, 99, 68, 90, 96, 99, 69, 73, 94, 70, 78, 71, 72, 73, 74, 75, 93, 76, 78, 93, 77, 78, 79, 89, 90, 80, 81,
         91, 82, 83, 84, 85, 86, 98, 99, 87, 88, 89, 97, 90, 99, 91, 96, 92, 93, 99, 94, 95, 96, 97, 98, 99])
    A_indptr = np.array(
        [0, 1, 4, 11, 12, 24, 29, 39, 44, 49, 50, 57, 60, 64, 68, 76, 79, 91, 94, 95, 99, 102, 107, 112, 114, 122, 126,
         133, 139, 149, 151, 158, 161, 162, 163, 168, 172, 177, 178, 186, 199, 200, 205, 208, 209, 217, 222, 226, 229,
         232, 235, 239, 241, 246, 247, 252, 257, 258, 261, 265, 266, 268, 273, 275, 277, 279, 280, 282, 285, 289, 292,
         294, 295, 296, 297, 298, 300, 303, 304, 305, 308, 309, 311, 312, 313, 314, 315, 318, 319, 320, 322, 324, 326,
         327, 329, 330, 331, 332, 333, 334, 335])
    A_x = np.array(
        [2, 2, 3, 3, 12, 3, -2, 3, 0, -3, -1, 2, 17, 0, 10, -1, -1, 1, 6, 2, 0, -3, 3, -3, 2, 0, 0, 0, 0, 5, 1, -1, -1,
         0, 0, -1, 0, -2, 1, 3, -3, 2, 0, -1, 11, 3, -3, 0, -1, 2, 6, -4, -2, 0, 1, 0, -4, 11, -3, -3, 3, 0, 0, 1, 10,
         -6, 2, -2, 6, 0, 0, -1, 0, 3, 2, 0, 2, 3, 1, 29, 6, -1, 2, 3, 0, -2, 0, -3, -2, -1, 2, 3, -1, 2, 2, 6, 0, -2,
         -2, 11, 3, 3, 3, 1, 0, 1, -2, 2, 3, 0, 1, 0, 2, -2, 16, 0, -1, 0, 6, 6, 2, 3, 11, 1, 1, 3, 47, -4, 0, -12, 7,
         2, 0, 3, 0, 1, -2, 0, -1, 25, 1, -3, 0, -2, 1, 2, 3, 1, 2, 2, -2, 7, 2, 3, 0, -3, 0, 4, 11, -3, 2, 2, 2, 3, 2,
         1, 0, 1, 2, 0, 0, 2, 3, 1, 0, -1, 1, 2, 16, 0, -1, 0, -3, -9, 0, -3, 15, 4, 2, -1, -6, -3, -2, 2, 2, 3, 6, 3,
         2, 2, 12, 3, 0, 1, -1, 7, -1, -2, 2, 17, -1, 2, 1, 2, 1, 3, 1, 16, 2, -3, 6, -2, 4, 1, -1, -2, 3, 1, -2, 2, 0,
         0, 11, -3, 1, 3, 2, 3, 0, 6, 2, 2, 3, -1, 0, 0, 2, 20, 0, -3, -3, 0, 15, -3, 2, 0, -3, 2, 2, -1, 0, 3, 0, -2,
         1, 11, 11, 2, 11, 2, -3, 0, 0, 12, -3, 2, -3, 6, 0, 2, 2, 0, 20, 9, -3, 6, -1, -2, -1, 5, -1, 0, 4, -2, 2, 2,
         6, 2, 2, 1, 11, 3, 1, 2, 6, 15, -1, 9, 6, 15, -1, 3, 3, 12, 10, 11, 2, 0, 2, 2, 16, 2, 12, 1, 7, -3, 2, 12, 0,
         2, 2, 11, 6, 2, 17])
    L_indices_true = np.array(
        [0, 1, 67, 84, 2, 11, 24, 49, 52, 76, 78, 3, 4, 5, 24, 39, 41, 54, 55, 62, 67, 79, 85, 90, 5, 18, 24, 39, 41,
         54, 55, 62, 67, 79, 85, 90, 6, 16, 27, 31, 45, 48, 83, 84, 85, 86, 7, 28, 38, 57, 92, 8, 17, 32, 93, 99, 9, 10,
         30, 35, 55, 82, 86, 99, 11, 12, 24, 49, 52, 76, 78, 94, 12, 16, 24, 49, 52, 71, 76, 78, 94, 13, 28, 46, 65, 14,
         19, 20, 30, 54, 59, 77, 86, 15, 16, 45, 16, 19, 24, 27, 31, 36, 45, 48, 49, 51, 52, 66, 71, 74, 76, 78, 79, 83,
         84, 85, 86, 89, 94, 17, 32, 79, 93, 99, 18, 24, 39, 41, 54, 55, 62, 67, 79, 85, 90, 19, 20, 24, 27, 30, 31, 36,
         45, 48, 49, 51, 52, 54, 59, 66, 71, 74, 76, 77, 78, 79, 83, 84, 85, 86, 89, 94, 20, 24, 27, 30, 31, 36, 45, 48,
         49, 51, 52, 54, 59, 66, 71, 74, 76, 77, 78, 79, 83, 84, 85, 86, 89, 94, 21, 47, 61, 84, 97, 22, 26, 54, 69, 94,
         23, 85, 24, 27, 30, 31, 36, 39, 40, 41, 45, 48, 49, 51, 52, 54, 55, 59, 62, 66, 67, 71, 74, 76, 77, 78, 79, 83,
         84, 85, 86, 89, 90, 94, 25, 47, 62, 71, 26, 53, 54, 61, 69, 89, 94, 27, 30, 31, 36, 39, 40, 41, 45, 48, 49, 51,
         52, 54, 55, 59, 62, 66, 67, 71, 74, 76, 77, 78, 79, 83, 84, 85, 86, 88, 89, 90, 94, 98, 28, 38, 44, 46, 57, 65,
         68, 76, 90, 92, 93, 99, 29, 91, 30, 31, 35, 36, 39, 40, 41, 44, 45, 48, 49, 51, 52, 54, 55, 59, 62, 66, 67, 71,
         74, 76, 77, 78, 79, 82, 83, 84, 85, 86, 88, 89, 90, 94, 98, 99, 31, 35, 36, 39, 40, 41, 43, 44, 45, 48, 49, 51,
         52, 54, 55, 59, 62, 66, 67, 71, 74, 76, 77, 78, 79, 82, 83, 84, 85, 86, 88, 89, 90, 94, 98, 99, 32, 79, 93, 99,
         33, 34, 42, 58, 64, 87, 35, 36, 39, 40, 41, 43, 44, 45, 48, 49, 51, 52, 54, 55, 59, 62, 66, 67, 71, 74, 76, 77,
         78, 79, 82, 83, 84, 85, 86, 88, 89, 90, 94, 98, 99, 36, 39, 40, 41, 42, 43, 44, 45, 48, 49, 50, 51, 52, 54, 55,
         59, 62, 66, 67, 71, 74, 76, 77, 78, 79, 82, 83, 84, 85, 86, 88, 89, 90, 94, 98, 99, 37, 38, 44, 46, 50, 51, 54,
         57, 65, 68, 76, 89, 90, 92, 93, 95, 97, 99, 39, 40, 41, 42, 43, 44, 45, 48, 49, 50, 51, 52, 54, 55, 59, 60, 62,
         63, 66, 67, 70, 71, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 88, 89, 90, 93, 94, 98, 99, 40, 41, 42, 43,
         44, 45, 48, 49, 50, 51, 52, 54, 55, 59, 60, 62, 63, 66, 67, 70, 71, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85,
         86, 88, 89, 90, 93, 94, 98, 99, 41, 42, 43, 44, 45, 48, 49, 50, 51, 52, 54, 55, 59, 60, 62, 63, 66, 67, 68, 70,
         71, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 88, 89, 90, 91, 93, 94, 98, 99, 42, 43, 44, 45, 48, 49, 50,
         51, 52, 54, 55, 58, 59, 60, 62, 63, 64, 66, 67, 68, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86,
         87, 88, 89, 90, 91, 93, 94, 98, 99, 43, 44, 45, 48, 49, 50, 51, 52, 54, 55, 58, 59, 60, 62, 63, 64, 66, 67, 68,
         70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 93, 94, 98, 99, 44, 45, 46, 48,
         49, 50, 51, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81,
         82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 45, 46, 48, 49, 50, 51, 52, 54, 55, 57, 58,
         59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89,
         90, 91, 92, 93, 94, 95, 97, 98, 99, 46, 48, 49, 50, 51, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68,
         69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99,
         47, 61, 62, 71, 84, 97, 48, 49, 50, 51, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73,
         74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 49, 50, 51, 52,
         54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85,
         86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 50, 51, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67,
         68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98,
         99, 51, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82,
         83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 52, 54, 55, 57, 58, 59, 60, 62, 63, 64, 65, 66,
         67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97,
         98, 99, 53, 54, 61, 69, 89, 94, 54, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75,
         76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 55, 57, 58, 59, 60, 61,
         62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91,
         92, 93, 94, 95, 97, 98, 99, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77,
         78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 58, 59, 60, 61, 62, 63, 64, 65,
         66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95,
         97, 98, 99, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 81, 82, 83, 84, 85,
         86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75,
         76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 61, 62, 63, 64, 65,
         66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,
         95, 97, 98, 99, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,
         87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 63, 64, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79,
         80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 64, 65, 66, 67, 68, 69, 70, 71, 73,
         74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97, 98, 99, 65, 66, 67,
         68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 97,
         98, 99, 66, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92,
         93, 94, 95, 97, 98, 99, 67, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
         90, 91, 92, 93, 94, 95, 97, 98, 99, 68, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87,
         88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 69, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
         86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 70, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
         85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 71, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
         85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
         85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,
         87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
         90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,
         94, 95, 96, 97, 98, 99, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,
         99, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 79, 80, 81, 82, 83,
         84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91,
         92, 93, 94, 95, 96, 97, 98, 99, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 82,
         83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,
         94, 95, 96, 97, 98, 99, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 85, 86, 87, 88, 89, 90,
         91, 92, 93, 94, 95, 96, 97, 98, 99, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 87, 88, 89, 90, 91,
         92, 93, 94, 95, 96, 97, 98, 99, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 89, 90, 91, 92, 93, 94, 95, 96,
         97, 98, 99, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 91, 92, 93, 94, 95, 96, 97, 98, 99, 92, 93, 94, 95, 96, 97,
         98, 99, 93, 94, 95, 96, 97, 98, 99, 94, 95, 96, 97, 98, 99, 95, 96, 97, 98, 99, 96, 97, 98, 99, 97, 98, 99, 98,
         99, 99])
    L_indptr_true = np.array(
        [0, 1, 4, 11, 12, 24, 36, 46, 51, 56, 57, 64, 72, 81, 85, 93, 96, 119, 124, 135, 162, 188, 193, 198, 200, 232,
         236, 243, 276, 288, 290, 326, 362, 366, 367, 372, 407, 443, 444, 461, 502, 542, 583, 627, 670, 719, 767, 814,
         820, 866, 911, 955, 998, 1040, 1046, 1088, 1129, 1130, 1170, 1209, 1247, 1285, 1322, 1358, 1393, 1427, 1460,
         1492, 1523, 1554, 1584, 1613, 1641, 1642, 1669, 1695, 1720, 1744, 1767, 1789, 1810, 1830, 1849, 1867, 1884,
         1900, 1915, 1929, 1942, 1954, 1965, 1975, 1984, 1992, 1999, 2005, 2010, 2014, 2017, 2019, 2020])
    L_x_true = np.array(
        [1.4142135623731, 1.4142135623731, 2.12132034355964, 2.12132034355964, 3.46410161513775, 0.866025403784439,
         -0.577350269189626, 0.866025403784439, 0, -0.866025403784439, -0.288675134594813, 1.4142135623731,
         4.12310562561766, 0, 2.42535625036333, -0.242535625036333, -0.242535625036333, 0.242535625036333,
         1.455213750218, 0.485071250072666, 0, -0.727606875108999, 0.727606875108999, -0.727606875108999,
         1.4142135623731, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.23606797749979, 0.447213595499958, -0.447213595499958,
         -0.447213595499958, 0, 0, -0.447213595499958, 0, -0.894427190999916, 0.447213595499958, 1.73205080756888,
         -1.73205080756888, 1.15470053837925, 0, -0.577350269189626, 3.3166247903554, 0.904534033733291,
         -0.904534033733291, 0, -0.301511344577764, 1.4142135623731, 2.44948974278318, -1.63299316185545,
         -0.816496580927726, 0, 0.408248290463863, 0, -1.63299316185545, 3.20156211871642, -0.937042571331636,
         0.156173761888606, -0.234260642832909, 0, 0.234260642832909, 0.078086880944303, -0.937042571331636,
         1.45669187528186, 0, 0.100461508640129, -0.150692262960193, 0, 0, 0.150692262960193, 0.0502307543200643,
         0.0837179238667738, 3.16227766016838, -1.89736659610103, 0.632455532033676, -0.632455532033676,
         2.44948974278318, 0, 0, -0.408248290463863, 0, 1.22474487139159, 0.816496580927726, 0, 1.4142135623731,
         2.12132034355964, 0.707106781186547, 4.9295030175465, 1.21716123890037, 0, -0.162288165186716,
         0.040572041296679, 0.40572041296679, 0.304290309725092, 0, 0, -0.40572041296679, 0, 0, 0, -0.608580619450184,
         0, 0, -0.40572041296679, -0.162288165186716, 0, 0.0811440825933579, -0.040572041296679, 0.40572041296679, 0,
         1.47709789175199, -0.123091490979333, 1.35400640077266, 0, 0.184637236468999, 1.4142135623731, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 2.12568071885655, 0, 0, 0.0929259330647674, 0, -0.0232314832661918, -0.232314832661918,
         -0.174236124496439, 0, 0, 0.232314832661918, 0, 0, 0, 0, 0, -0.592402823287892, 0, 0, 0, 0.232314832661918,
         0.0929259330647674, 0, -0.0464629665323837, -0.917643589014578, -0.232314832661918, 0, 3.3166247903554, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0.904534033733291, 0, 0.904534033733291, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1.73205080756888, 0.577350269189626, 0, 0.577350269189626, -1.15470053837925, 1.4142135623731,
         2.12132034355964, 0, 0.707106781186547, 0, 1.4142135623731, -1.4142135623731, 3.12247193211877, 0, 0, 0, 0,
         0.188387696320619, 0, -0.131871387424433, 0, 0, 0.176694666893822, 0, 0, -0.188387696320619, 0.7912283245466,
         0, -0.376775392641238, 0, 0, 0, 0, 1.74485983557649, 0, 0.581619945192164, 0.565163088961857, 0, 0,
         0.3956141622733, 0, 0, 0.565163088961857, 0.0441736667234555, 3.3166247903554, 0.301511344577764,
         0.301511344577764, 0.904534033733291, 6.51920240520265, -0.613571991077896, 0, -1.84071597323369,
         0.843661487732107, 0.306785995538948, 0, 1.66283713045036, 0, -0.115018378588463, 0.0525798302118689, 0, 0, 0,
         0.0394348726589017, 0, 0, -0.0525798302118689, 0, 0, 0, 0, 0, 0, 0, 0, -0.0262899151059345, 0, 0, 0,
         -0.0525798302118689, 0.460073514353853, 0, -0.230036757176927, -1.03516540729617, 0, 0.0525798302118689, 0, 0,
         -0.601381808048251, 4.28952211790544, 0.466252404120157, 0.233126202060078, -0.419627163708141, 0,
         -0.279751442472094, -0.466252404120157, 0.233126202060078, 0.466252404120157, 0.466252404120157,
         0.233126202060078, 0.466252404120157, 1.4142135623731, -1.4142135623731, 2.04124145231931, 0, 0.32659863237109,
         0, 0, 0, 0, 1.46969384566991, 0, 0, 0, 0, 0, 0, 0, -1.22474487139159, 0, 0, 0, 0, 0, 0, 0.163299316185545, 0,
         0, 0.326598632371091, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.65319726474218, 3.28398918698542, 0, -0.00481435101628795,
         0, 0, 0, -0.913523105340639, 0, -0.00361076326221596, 0, 0, 0.00481435101628795, 0, 0, 0, 0, 0, 0, 0, 0,
         0.00240717550814397, 0, 0, 0, 0.00481435101628795, 0, -0.0421255713925196, 0, 0.477824338366579,
         0.0186556101881158, 0, -0.00481435101628795, 0, 0, -0.0210627856962598, 0, 1.08012344973464, 0.154303349962092,
         0, -0.231455024943138, 1.4142135623731, 1.73205080756888, 1.15470053837925, 0.577350269189626, 0,
         0.577350269189626, 1.10754984838908, 0, 0, 0, 0, 0, -0.433389071108769, 0, 0, 0, 0, 0, 0, 0, 0.361157559257307,
         0, 0, 0, 0, 0, 0, -0.0481543412343077, 0, 0, 0.204655950245808, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.409311900491615,
         1.66692319814277, 0, 0, 0, 0.599907662881031, -0.00263840643378133, 0, -0.0995998428752454, 0, 0, 0,
         0.132799790500327, 0, 0, 0, 0, 0, 0, 0, 0, 0.0663998952501636, 0, 0, 0, -0.467107872380704, 0,
         0.0378171588841991, 0, -0.0175893762252089, -0.0853084746922631, 0, 0.467107872380704, 0, 0,
         0.0189085794420996, 0, 1.4142135623731, 3.80122024648912, -0.0285949366586444, 0.0514708859855599,
         -0.263073417259528, 0, -0.789220251778585, 0, 0.0343139239903732, 0.0571898733172887, -0.0285949366586444,
         -2.36766075533575, -0.0571898733172887, 0.11819240485573, -0.0285949366586444, 0, -0.789220251778585,
         -0.0571898733172887, 3.8607883322533, 0, -0.00880146218853689, 0, 0, 1.03605783476491, 0, 0, 0.509407076871237,
         0, 0, 0, -0.234585910576106, -1.50127797901615, 0, -0.777043376073685, 0.0488570962302456, -0.518028917382457,
         0, 0, 0.518028917382457, 0, 0, 0.518028917382457, -0.0851406750482956, 0, -0.0283802250160985,
         0.703757731728317, 1.55408675214737, 0, 0, 0, 0.0264043865656107, 0, 0, 0, 0.703757731728317,
         0.518028917382457, -0.00215546012780495, 0, 0, 1.4142135623731, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3.45307239165795, 0, 0,
         0.00264078560294605, 0, 0.868791516577383, 0.00804631205142541, 0, 0, 0, 0.00924274961031117,
         0.128600869505099, 0, -0.00198058920220954, 0.0198058920220954, -0.00132039280147302, 0, 0, 0,
         0.00132039280147302, 0, 0, 0.00132039280147302, 0.0664184525932798, 0, 0.0221394841977599, -0.0277282488309335,
         0.29355835059688, 0, 0, 0, 0.0662810239547591, 0, 0, 0, -0.0277282488309335, -0.289597172192461,
         0.00132039280147302, 0.0016814798124881, 0, 0, 2.30364438720113, 0.000687085318469269, 0, 0.0259374707722149,
         0, 0, -0.434094778497897, -0.0345832943629532, 0, 0, 0, -0.289396518998598, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         -0.868189556995794, -0.0172916471814766, 0, 0, 0, 0, 0.121642729923997, 0, 0, -0.00984822289805952, 0,
         0.00458056878979513, 0.0222157586305064, -0.289396518998598, 0, -0.121642729923997, 0, 0, 0, 0,
         -0.00492411144902976, 0, 1.07956847987242, 0, -0.00331532631443987, 0, 0, 0.000276277192869989,
         0.00442043508591983, 0, 0, 0, 0.00018418479524666, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000552554385739979,
         0.00221021754295991, 0, 0, 0, 0, 0.00285486432632322, 0, 0, -0.0355476654826053, 0, 0.404285625566418,
         0.0155636151983427, 0.00018418479524666, 0, -0.00285486432632322, 0, 0, 0, 0, -0.0177738327413027, 0,
         3.67744280796148, 0, -0.244926203711171, -0.000623882477239942, -0.143522678454579, -0.00204559746974809,
         0.543856180623692, 0, 0.0599472162751617, 0.422867543073233, 0, 0, 0.532033220175351, 0.218920361263496,
         -0.013778890140185, 0.145946907508997, 0, 0.0180012577337832, 0, 0, 0.030002096222972, 0.271928090311846,
         -0.145946907508997, 0, 0, 0, 0.397909273114695, 0.280866304112739, -0.0709377626900469, 0.00797975397079278,
         -0.198252026053218, -0.438048683352738, -0.10640664403507, 0, 0, -0.0074865897268793, 0, 0, 0,
         -0.0184103772277328, -0.22825412227619, 0.000207960825746647, -0.0286383645764733, 0.654836315315056,
         0.000606057263604515, 0.271928090311846, -0.00613679240924428, 0, -0.242815384293113, 3.9198057555261, 0, 0, 0,
         0.0028726516774035, 0.0459624268384559, 0, 0, 0, 0.510229364600637, 0.001915101118269, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, -0.765344046900956, 0, 0.00574530335480699, 0.022981213419228, 0, 0, 0, 1.53068809380191,
         0.0296840673331695, 0, 0, 0.0130575076245613, 0, -0.00574530335480699, -0.539739331832146, 0.001915101118269,
         0, -0.0296840673331695, 0, 0, 0, 0, 0, 0, 0, 0.00652875381228067, 0, 1.8333780150612, -8.33462414499386e-05,
         -0.0191736044021264, 0.0071123365371952, 0.0726552999930958, 0, 0.0301653610154544, 0.0564920824547684, 0,
         0.545441252041313, 0.0710758369497676, 0.0292461961247835, -0.0018407612754515, 0.019497464083189, 0,
         0.155587939289207, 0, 0, -0.104314269212196, -0.509113602044765, -0.019497464083189, 0, 0, 0,
         0.0531578359099068, 0.0916828989531394, -0.00947677825996902, 0.00106603811683112, -0.0264850542116062,
         -1.14940267841268, -0.0142151673899535, 0, 0, -0.00100015489739926, 0, 0, 0, 0.0640110288347568,
         0.0778292150005901, 2.77820804833129e-05, 0.0995727115207329, 0.141642620512553, 8.09649202656547e-05,
         0.0363276499965479, 0.0213370096115856, 0, 0.0758839344322893, 1.60491668810489, 0, 0.566441184037021,
         -0.169932355211106, -0.207695100813574, -0.830780403254297, 1.11588570406974, -0.0063462655325912,
         -6.12451522649123e-07, 0.000309492169445357, 0, -0.00716032854878466, -0.0998837210575805, 0,
         4.07393679510305e-05, 0.00030276407880524, 0.00166660189995159, -0.0154280503217345, 0.00111106793330106, 0,
         2.16853205797245e-05, 0, 0, 8.98262233218714e-06, 0.000114006716771648, -0.00111106793330106, 0, 0, 0,
         -0.000801575763855704, -0.0515473215194335, -4.03685438406987e-05, -0.0172325254309967, 0.0214754735826501,
         -0.228885532791032, -6.05528157610481e-05, 0, 0, -0.0516084624287418, 0, 0, 0, -5.51206370384211e-06,
         0.0214664909603179, 0.225470850255226, -8.57432131708772e-06, -0.000651320990299119, -0.00130879939982253,
         0.000154746084722678, -1.83735456794737e-06, 0, -0.000130088253854283, 3.14016334181326, -5.00688564335593e-05,
         0.0253014621177586, 0, 0.0515416425717443, -0.73720324660956, 0, 0.00333050615387676, 0.02475143033259,
         0.136247275375588, 0.0125521813650313, 0.0908315169170587, 0, 0.00177280839816603, 0, 0, 0.000734343227692203,
         0.00932022490500255, 0.227623254745411, 0, 0, 0, -0.0655300547993001, 0.192301162533453, -0.003300190711012,
         0.0600058676961398, -0.155075547423135, -0.280362973778337, -0.004950286066518, 0, 0, -0.0271667411866639, 0,
         0, 0, -0.000450619707902034, -0.155809890650827, 0.00120741071940728, -0.00070096399006983,
         -0.0532464953542669, -0.0680019073892103, 0.0126507310588793, -0.000150206569300678, 0, -0.0106349153607282,
         1.65598641288152, -0.00878549112114862, 0, -0.125431108051191, 0.000257401856243673, -0.000885098590591759,
         -0.0782073234876983, 0.000352690090727828, 0.000148936556404845, -8.74096827405823e-06, 9.92910376032298e-05,
         0, 0.00480523239775509, 0, 0, 0.00957040616792135, 0.00252279208164407, 0.00123798534892845, 0,
         0.980144992146354, -0.00457300938472409, 0.000261236610696328, -0.00458367964014142, -4.70253454303771e-05,
         -0.00264820923188545, 0.0316992266648095, 0.0043869259409648, -7.05380181455657e-05, -0.00259830078677505, 0,
         0.00113745946886407, 0.00675725836870337, -0.075864795230204, 0, 1.40334486572908, -0.00970623127191511,
         2.57461214086636e-07, 0.0183132345178243, -0.00434370264911457, -1.65561737030064e-06, 0.000180263824149779,
         -0.125476383085855, -0.00129915039338753, -0.00971148220421248, 2.33578536953393, 0, -0.0159253391424963,
         -0.0922165556153275, -0.0100433696404985, -0.0216191476153344, -0.126354432097757, -0.0533578756474112,
         0.00313153136787574, -0.0355719170982742, 0, -0.00903209215472235, 0, 0, -0.00371281671315629,
         -0.0475701488662264, 0.0471874736490585, 0, -0.00928180764601548, -0.0518907431425756, -0.0935903912683215,
         -0.0703411978920663, 0.0168472576130342, -0.0326689262766111, -0.0182230077787051, 0.140829999750068,
         0.0252708864195513, -0.0294833767855543, 0, 0.0150480367604462, 0.0766758011758513, -0.00460814229826298, 0,
         0.0745820764155715, 0.0523733953087539, -9.2237821102324e-05, 0.00364729366366676, -0.156315137095041,
         0.000593139977831002, 0.791661900545259, 0.000294853722702865, -0.0147416883927772, 0.0542545895522589,
         1.4142135623731, 0, 0, 0, 0, 0, 0, 2.12132034355964, 0, 0, 0, 0, 0, 0, 0, -0.707106781186547, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.27417793567645, 0, -0.886384650905358,
         0.406259631664956, 0.147730775150893, 0, 4.28792748729976, -0.12790781747283, -6.31920584975881e-05,
         -0.00624514381618976, -0.00869406007130599, -0.047601678595525, 0, -0.0413197061752885, -0.0317344523970167, 0,
         0.00505522083968812, -0.190810553724418, 0, 0.0110979151689567, -0.000434810048897238, 0.0279888283566078, 0,
         0.0286368780360256, -0.000326492302237538, 0.0228471909907927, 0.0592307525593386, 0.00115920800950747,
         0.0228848707734835, -0.589374620619737, 0.102238205240229, 0.0017388120142612, -0.000185506989907692, 0,
         -0.0220312252575634, 0.000482437855688973, -0.00223632316197505, 0, -0.394642646088083, -0.601155374300031,
         0.0009827932592499, 0.022011609191019, 0.0128546027032025, 0.00262752025317282, -0.00126354869954563,
         -0.14899285961989, -9.27534949538461e-05, -0.00762029114043429, 3.03737038532191, -0.000307509381073786,
         -0.0102477124684338, -0.0735774034390845, -0.385508019613597, 0, -0.108093225849556, -0.257005346409065, 0,
         -0.00503069738277253, -0.00803529315871885, 0, -0.00170445511567373, -0.0275861676410002, -0.653203831236536,
         0, 0.000841073946662228, -0.00158879846888123, 0.181792889560223, -0.494896996589202, 0.00981032045854461,
         -0.15363686005076, 0.516180544689961, 0.771077986670582, 0.0147154806878169, -0.000902726402773424, 0,
         0.209352593490477, 0.00234767105134172, -0.000227651685013118, 0, -0.0132104781567401, 0.519889571921636,
         0.0199781741234534, 0.00300083243236219, 0.145038888693639, -0.0291487905710292, -0.0114762104955528,
         -0.00583369792509808, -0.000451363201386712, -0.95656105098513, 1.4142135623731, 1.31892541270184,
         -0.000960658584887664, -0.000979499846370799, -0.00049837270482549, 0, -3.34163537745259e-06,
         -0.00033224846988366, 0, -6.64837235656123e-05, -1.10155127492255e-05, 0, -2.17156127286153e-05,
         -0.000366997364990634, 0.296284325355297, 0, -0.00163394371812295, -0.00928892906549114, -0.000669018039739824,
         -0.000651259129165558, 0.000130599979516107, -0.592435519582497, -0.0115087324619771, 0.00126001436245828,
         0.00019589996927416, -0.00527780060539269, 0, 0.00238569057594564, -0.548804595034579, -0.000827022695066557,
         0, 0.0129710413849328, 0.000484710557206458, 4.00282683491171e-06, 4.18172847387776e-05, -0.00115879348818726,
         -2.15465518013648e-06, 0.00602574162539018, -9.04575240457304e-05, -0.00263890030269635, 0.000183232681239382,
         1.50952530726541, -0.0280641002066862, -0.0144390818139102, 0, -0.000222514347161307, -0.00962605454260678, 0,
         -0.056116643708946, -0.000843969491310295, 0, 0.0381675534650125, 0.183199066030911, 0.00412376448220376, 0,
         -0.115680337954161, -0.00434261114891509, -0.0190616923353391, -0.0379109064084197, 0.00374188002755815,
         -0.00438949284492356, 0.0356339076791092, -0.901075377572278, 0.00561282004133723, -0.00246739269824721, 0,
         0.00286488718225488, 0.00605881984791814, 0.382148425667101, 0, 0.0256493658023268, -0.0264892549318315,
         0.000119599071671905, -0.0348648620412467, -0.0524893425068182, -5.7789736702831e-05, -0.00188621704704758,
         -0.0148621114069462, -0.0012336963491236, -0.033647233643804, 2.7492904592703, -0.0574150749229041, 0,
         -0.00027911540708882, -0.0382767166152694, 0, -0.00862904800610084, -0.000827060832809093, 0,
         -0.00290852482099247, -0.0406010050706679, 0.0116215009743691, 0, -0.00162067096768533, -0.00247544623432528,
         -0.0773449590935932, -0.075124810324587, -0.269577338191227, -0.00790637578310083, 0.0519119902836021,
         0.135267259139752, 0.141229309840227, -0.00140650354223027, 0, 0.00797952932645326, 0.00345374758703211,
         0.00368536777174304, 0, 0.0038245402492584, 0.0577097164675631, 0.000458091261562946, 0.00293342831783461,
         -0.133701534537528, -0.000252131417103546, -0.0176199817952602, -0.000112065735789643, -0.000703251771115136,
         0.258865562771889, 3.18929732738093, 0, -0.0012857699062647, -0.173158843997594, 0, -0.00383153463831434,
         -0.00383791435581013, 0, -0.00111672751817073, -0.0184338647189259, 0.0492122274167861, 0,
         -0.000225132933857388, -0.00113052973485621, 0.120483623922683, -0.110648401504444, 0.00174613989198601,
         -0.0290434048985952, 0.246296559746218, 0.627097380614059, 0.526969155842168, 0.0124412467304003,
         -0.000642346440259208, 0, 0.0335704338320734, 0.00157731736996983, 0.00166188956731949, 0,
         -0.00542179919150008, 0.248711295735988, 0.00207301103646328, 0.00172905261714786, 0.0947043776443124,
         -0.00113975792399506, -0.00802551685591442, -0.0027554629453971, -0.000321173220129604, -0.0938966035992033,
         2.61267811957802, 0, 0, 0.765498047774452, 0, 0, 0, 0, -0.416031547703506, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0.266260190530244, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.58731720354481, -0.0011426678222329, 0,
         7.19354459759081e-05, -0.00338503145789134, 0, 0.000195019373970424, -5.82244267484964e-05, -0.618318648720275,
         -0.0682060120009704, 0.00049678008181631, -1.00154979674078e-05, 0.000800838076704171, 0.23580222869702,
         1.13313727799576e-05, 0.0786835407536115, 0.21774794263713, 0.00031163667879079, -0.000873275075528785,
         8.07360310571988e-05, -5.69062384511806e-06, 0.0454706746673136, -0.0716295276490113, 1.39736429974566e-05,
         -5.81614662288073e-06, 0, -0.00699032890039582, 0.217543618088365, 0.00440815284162046, 0.000392397396184145,
         0.000532413516954599, 0.00560882608820486, -5.02946256098488e-05, 0.179239323203559, -2.84531192255903e-06,
         -0.0413606584312917, 1.26564002918408, 0, -0.00696089237729759, -0.00697560383781823, 0, -0.00202864353524626,
         -0.0334898569734367, 0.0888482880149031, -6.15789745893101e-05, -0.000408562731007754, -0.00205390388607578,
         0.218889874100125, -0.200808076504019, 0.00317231752135765, -0.0526936944766608, 0.447656943968018,
         0.0857967598166585, -1.41296949097113, 0.0226027623396733, -0.00116699084436124, 4.10526497262067e-05,
         0.060924562735243, 0.00286561085115371, 0.00301923989385681, 0, -0.00985638854440218, 0.452043741673874,
         0.00377013172086616, 0.00314161818087007, 0.172055073253937, -0.00206559633578363, -0.0145804382805532,
         -0.0048441753064023, -0.00058349542218062, -0.170624407510226, 2.32680311561883, 0, 0, 0, 0, 0.13687077150699,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0875972937644736, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1.22171382698087, 0.000660261102630855, 0, -0.0939290381497357, 0.0682225250402654, 0.00282625537657699,
         3.66516706107275e-06, -0.00936685908226887, -0.000603536503707833, -0.0123734446786811, 0.031530498099257,
         0.000708630649484019, -0.00198419389554754, 0.0161365205907099, 0.00245552179475094, 0.110188953185811,
         0.00504899337757363, -0.000342918468015814, -2.44344470738183e-06, 0.00198272529288236, 0.000842055349238833,
         0.0178741568387023, 0, 0.056363214464731, 0.109634539081749, 0.000101610860671092, 0.0895051190553601,
         0.0239025620998028, -6.71581704578615e-05, -0.00316047976298943, 0.0198978621458607, -0.000171459234007907,
         0.0978498966068005, 1.07017207448884, 0, 0.00203514088742071, -0.000498237399558461, -0.00110077257168212,
         -0.000216144181158718, 0.00502362196410466, -9.26774733700819e-05, 0.00723281433864478, 0.00577761063111321,
         0.000101498983615521, 0.00271358971031695, -0.0966610741675894, 0.00280764554846718, 0.0160215466075087,
         0.000723180258260586, -5.26576553239101e-05, 0.000144096120772479, -0.0020580693749775, 0.000129303798073157,
         -8.16362829879116e-05, 0, -0.0705808159084273, -0.0987991868797267, 0.00037157322938182, 0.00389464823352436,
         0.00468430089206698, 0.000249613607438169, -0.000448529352042425, -0.0261076665611629, -2.63288276619551e-05,
         -0.0100075187475559, 3.93700393700591, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.14300114300171, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.762000762001143, 2.39938054650623, -0.0259674560419758, 0.000593242018179886,
         5.81846905045054e-06, -0.00258898411630942, -2.14900684717477e-05, -0.00280676033409087, 0.047183318614298,
         0.000148725571956808, -0.000416275405052865, 0.00499808108776665, 0.000458125750892589, -0.026283192389227,
         0.00105966970019225, -1.22102661771294e-05, -3.87897936696703e-06, 0.000444450021823404, 2.99829869460621e-05,
         -0.00506569946479051, 0, 0.0576337156647977, -0.309905722988463, 1.30058893851119e-05, 0.0963683128188813,
         0.0455824043584222, -2.01361161735564e-05, -0.000733432413357229, -0.833548476881762, 0.0220190550233202,
         -6.10513308856469e-06, -0.314487579925246, 1.74731592128741, 0.00879490481744288, -3.57129134585952e-06,
         -0.561544677487721, -0.00106351217422876, -0.0396484175561248, -0.0310333560175207, 0.00230758527552885,
         -0.00564525782559572, 0.0394928994314746, 0.00817192861518055, -0.1777842632771, 0.016441545088143,
         -0.000604268280811794, 2.38086089723968e-06, 0.00606335904227415, 0.00148381433399341, -0.0406991285881637, 0,
         -0.0952092741155808, 0.0750263325174216, 0.000356436764945262, 0.03533942217317, -0.0558730244453159,
         -0.000200141171757768, -0.0108930178524786, -0.0123876473444682, 0.00821536281464513, -0.000302134140405897,
         0.0431262462224786, 1.28920695193898, -0.0327083237117403, 0.00750569747992344, 0.0171080814053397,
         -0.0737811217663119, -0.0838981265019604, -0.00117147875155035, -0.539330321999803, 0.0802419770433977,
         -0.0297601993012948, -0.179915026365128, -0.00834678610479629, 0.00972050079848844, 0.0218055491411602,
         0.0552887378312745, -0.196240486260203, 0.000212524637512655, 0, -0.0259864575769611, 0.0571148476349169,
         0.012173569707197, -0.00121809183016082, -0.0568134281534147, 0.000972561497857129, -0.00551545276937603,
         0.00046807392643607, 0.0863846117934774, 0.00486025039924422, -0.518070371917495, 1.07108320469848,
         0.000260004818503793, 0.000521664026720661, -0.0021881329128579, 0.012442866076667, -3.48452607476119e-05,
         -0.0114618256958693, 0.0163227521593894, -0.000883444985112053, -0.00562861373185701, -0.000248272482826735,
         0.000296400015182194, -0.0293903288309914, -0.00286984600356468, -0.00599163331783047, 6.1073867404016e-06, 0,
         -0.00125433807301872, 0.0156048234978601, 0.000652753101105868, -1.19553523290896e-05, -0.0016907212200895,
         0.000386798072957303, -0.000172581790166058, 1.87806601164929e-05, -0.117761055150057, 0.000148200007591097,
         -0.018464768782941, 1.4142135623731, 1.98890076087592, -0.00622859330157302, -0.0130809809341598,
         -0.00934399718105771, 0.000739105232954447, -0.0038896257603222, 0.0589166550648459, 0.00251328007089983,
         -0.104902661707776, 0.00526612478480044, -0.00353897346680285, -8.95048356434123e-05, 0.00337019931947005,
         0.00934132732662136, -0.078118601070716, 0, -0.763315099113081, 0.0333646810092321, 3.82516611624553e-05,
         -0.000831311068604196, -0.0173526551141477, -8.86456377034576e-05, 0.000436338668694376, -0.00458433094471668,
         0.0652713482198204, -0.00176948673340143, 0.0179825068760445, 1.12675835218103, -0.00276967317664044,
         -0.00352477610464486, 0.00024508625365696, -0.029821229972816, -0.0692434948108835, 0.00126102603873032,
         0.00445469415653551, 0.00174623955730584, -0.0321461951004186, -0.00031747948699022, 0.0138077124612459,
         -0.510107832420407, -0.00398442234729278, 0, 0.0747486755873369, 0.00346113556026567, -0.000149805625986834,
         0.000230148179836353, -0.00637631960926659, -3.43250610605666e-05, 0.0364859630313826, -6.00474844664443e-05,
         -0.00149494371692747, -0.0160730975502093, 0.00920345777724093, 1.20319315454058, 0.0544364066207496,
         0.00550290344482459, 0.0111105649226972, -0.407751213778594, -0.0799216612431996, -0.415041630124026,
         0.0392081870443753, -0.0015477059616285, 0.00124343144583631, -0.050628566938828, -0.00812795218795357,
         0.00329578957656264, 0, 0.0095010426315284, -0.399078014976681, -0.00268731570561713, 0.00553646471635078,
         0.292630151338572, 0.0019375954641179, -0.0258514006581685, -0.00237391573312594, 0.0121074969569668,
         -0.00077385298081425, 0.25201240482906, 2.55949188064867, 0.0030343124621912, 0.598354453961195,
         -0.173857952128294, 0.0346059336480653, 0.202525955862283, 0.0216194762931123, -0.000893001845547158,
         -0.00335568166408183, -0.211188292984679, -0.00398690838132506, 0.00484885712768855, 0, -0.0219010546711554,
         -0.210620861324126, 0.0162284906757491, -0.0440799739547362, 0.33971432779828, 0.0491886041678539,
         -0.0142080599361304, 0.0152648930216709, -0.021138899652572, -0.000446500922773579, -0.225263019579405,
         1.10728819106779, -0.00135527947216827, -0.00374065639627886, -0.000984742129149021, -0.00694366295901982,
         -0.0127601299345015, 0.000158956104831431, 2.46918574935011e-05, -5.60787174109552e-05, -0.000366695769585941,
         -0.000236446669276743, 0, 0.000341143561210441, -0.00432217521701545, -7.32947171970699e-05,
         -0.000320425172406446, 0.00873174171371121, -0.000113129891782298, 0.00177594376818429, 0.00011131023919377,
         3.79924766871129e-05, 7.94780524157152e-05, -0.0233456317146586, 1.47828119177791, -0.0621904334247146,
         -0.00884828245535378, -0.0676925163990725, -0.00724467977203489, -0.013190017768806, 0.00665083348129574,
         -0.0132336479540013, 0.260820188582698, -0.00357487154744643, 0, 0.0435759950388843, -0.0164688107951315,
         0.00681504991374111, 0.0178827586499916, -0.134302693531282, 0.00892505246026854, 0.0205820618309284,
         -0.00628511535660375, 0.0309799773143713, -0.00659500888440299, -0.200228622082909, 3.18182240357454,
         -0.0684527444620509, -0.36426669544891, -0.00943167716271238, -0.0151365717046081, -0.00341157323548615,
         0.0315846178401652, 0.0313102784455052, 0.00889348534919408, 0, -0.238417653950917, 2.02186251299227,
         -0.00766686414361363, -4.50990901237857e-05, -0.0702709750799648, -0.00230807374246746, 0.0244073308956994,
         0.00194194847068175, -0.0396596513905912, -0.00756828585230405, 0.130304800492454, 2.36348521299224,
         -0.118005685578595, -0.00359272189762985, -0.000168240445669891, 0.000273466533048888, -0.0082004504239628,
         -0.00107305016475876, -5.48945192598662e-05, 0, -0.00351526159560565, -0.0338524247829994, -0.0010607378365711,
         7.22133052519995e-05, -0.0295268157132604, -0.000298551771856995, 0.00272941565077275, -5.58113667301969e-05,
         0.00152235970941921, -8.41202228349454e-05, 0.0392151591478352, 2.58315824936888, -0.0229254834171113,
         -0.00150658894027209, 0.00165741307097129, -0.0516003102111593, -0.00361512517092551, 0.12950149015424, 0,
         -0.0273902835082693, -0.150400660564713, -0.340180370547385, 0.0306879292430258, -0.118817326545556,
         -0.00218818135531834, 0.0179247383838834, -0.0109585456936703, 0.016474337554818, -0.000753294470136045,
         0.208093547965555, 1.6274173160946, 0.000603801286253551, 0.000153682461241374, -0.000893161328501948,
         -0.000491309489437792, 0.000711693655426164, 0, 7.51077564714356e-05, -0.0115360885247986,
         -0.00516446365701571, -0.00104406874488542, 0.0396542969009992, -0.000554449868627015, 0.00911499103260333,
         0.000369263738215635, 0.000327978731038832, 0.000301900643126776, 0.196758599950125, 1.59566893716127,
         -0.000110297325384029, -0.150882412014974, 0.473543597864532, -0.00149612878862039, 0, 0.0295652743445613,
         0.019855974543356, -0.000392380125399665, 0.000254479009956952, -0.00412069850943941, 6.49489443626162e-05,
         0.0157559195853559, -6.30969669027974e-05, -0.000734535793154634, 0.171138055113428, 0.00370577469330145,
         2.41114065840008, 0.00065980042348564, 0.000982366398004853, -6.67898410814216e-05, 0, -0.000134662894282289,
         -0.00150164503241254, 4.32233464531951e-05, -0.000131221501371222, 0.00115374354800867, -6.86909857614512e-05,
         1.26361996636943e-05, 4.45540466585849e-05, 0.199149339150527, -2.8668148410331e-05, 0.366605133593669,
         2.43310672763683, 0.0790396712569252, 0.00324408888194389, 0, -0.00735690825271282, 0.00120996299086501,
         0.00495052207937374, -0.00329909420024251, 0.0136763492377937, -0.000904220451545102, -0.00305495945005762,
         0.00115899878616563, 0.00176080776688211, -0.0388628441472638, 0.0838026867987213, 2.77117632008852,
         0.00214325885612984, 0, -0.0363745074436816, -0.0241584737578312, -0.000242763185698655, -0.00180307437217622,
         0.0138473150145919, -0.000651451027903753, -0.0192135269994326, 0.000601316807999309, 0.00327134419921859,
         0.46905705694998, -0.0208377783941213, 1.18576240597807, 0, 0.00264179895302414, 0.0104512211910668,
         0.0371244621709391, 0.00954739629537141, 0.0234945924170125, 9.64865044086057e-05, 0.00173097987400223,
         -0.00318554294714117, -0.000503407579507053, -0.00153222654236139, -0.0144077980023474, 1.4142135623731, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 2.63369102546529, 0.0597054981569113, -0.00378785798520613, 0.0941211204558433,
         -0.025842676187646, 0.000224330299715297, -0.0215030044207439, 0.0167872680423289, 0.108787346055981,
         0.01340639583693, -0.0378618354747392, 2.22509102411402, -0.0268747290465545, -0.0927436624484588,
         -0.0754099117884679, -0.000706301608221056, -0.0104887305473501, -0.117580770894612, -0.0444050299361089,
         0.010353701504402, 0.467430169765053, 2.17863302006959, 0.00388712283368902, -0.0230426909955627,
         -0.000100624723682971, 0.00289069027310919, -1.38017572944446, 0.00147593803748982, 0.000204842533620387,
         0.0539247272587797, 1.1760568838727, -0.0788666663821361, 0.00168554668743968, 0.00145054590908448,
         0.063613229399355, 0.0643605359695852, 0.000501045170249757, -0.14514958611078, 3.29482004601702,
         -0.00441448543915782, -0.0118335104604029, -0.00134661979292157, -0.000878945631058985, -0.00222731712504792,
         0.0812111086218769, 1.05115392908113, 0.000424601612025449, -0.00101479129146001, -0.000280464514147319,
         0.000290086207941031, -0.0131549240432698, 1.13663432168971, 0.00239493888436173, 0.00249825195437557,
         0.016838681058315, 0.0102545188399419, 2.89509255487593, 0.00359012745621367, 0.000317337077177005,
         -0.0405383891281647, 1.78731214280295, -0.00167722951146767, -0.0242375025331707, 1.17692212563686,
         0.0093936758403204, 3.26164901627664])
    L_indices, L_indptr, L_x = sparse_cholesky_csc(A_indices, A_indptr, A_x)

    print("========================\n Big boy indices\n========================")
    print(sum(L_indices - L_indices_true))
    print("========================\n Sexy pointers \n========================")
    print(sum(L_indptr - L_indptr_true))
    print("========================\n Cholesky time! \n========================")
    print(np.sum(np.abs(L_x - L_x_true)))

    A_indices2 = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9])
    A_indptr2 = np.array([0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19])
    A_x2 = np.array([0.6, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, 1, 1, 1, 1, 1, 1, 1, 1, 1])
    L_indices_true2 = np.array(
        [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 2, 3, 4, 5, 6, 7, 8, 9, 3, 4, 5, 6, 7, 8, 9, 4, 5, 6,
         7,
         8, 9, 5, 6, 7, 8, 9, 6, 7, 8, 9, 7, 8, 9, 8, 9, 9])
    L_indptr_true2 = np.array([0, 10, 19, 27, 34, 40, 45, 49, 52, 54, 55])
    L_x_true2 = np.array(
        [0.774596669241483, -0.258198889747161, -0.258198889747161, -0.258198889747161, -0.258198889747161,
         -0.258198889747161, -0.258198889747161, -0.258198889747161, -0.258198889747161, -0.258198889747161,
         0.966091783079296, -0.0690065559342354, -0.0690065559342354, -0.0690065559342354, -0.0690065559342354,
         -0.0690065559342354, -0.0690065559342354, -0.0690065559342354, -0.0690065559342354, 0.963624111659432,
         -0.0741249316661101, -0.0741249316661101, -0.0741249316661101, -0.0741249316661101, -0.0741249316661101,
         -0.0741249316661101, -0.0741249316661101, 0.960768922830523, -0.0800640769025436, -0.0800640769025436,
         -0.0800640769025436, -0.0800640769025436, -0.0800640769025436, -0.0800640769025436, 0.957427107756338,
         -0.0870388279778489, -0.0870388279778489, -0.0870388279778489, -0.0870388279778489, -0.0870388279778489,
         0.953462589245592, -0.0953462589245593, -0.0953462589245593, -0.0953462589245593, -0.0953462589245593,
         0.948683298050514, -0.105409255338946, -0.105409255338946, -0.105409255338946, 0.942809041582063,
         -0.117851130197758, -0.117851130197758, 0.935414346693485, -0.133630620956212, 0.925820099772551])

    L_indices2, L_indptr2, L_x2 = sparse_cholesky_csc(A_indices2, A_indptr2, A_x2)

    print("========================\n Big boy indices\n========================")
    print(sum(L_indices2 - L_indices_true2))
    print("========================\n Sexy pointers \n========================")
    print(sum(L_indptr2 - L_indptr_true2))
    print("========================\n Cholesky time! \n========================")
    print(np.sum(np.abs(L_x2 - L_x_true2)))

    # sparse_cholesky(10, 3, A_indices, A_indptr)

# See PyCharm help at https://www.jetbrains.com/help/pycharm/
